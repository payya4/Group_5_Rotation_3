# Introduction

This project addresses the genomic analysis of *A. lyrata* species to understand the genetic diversity, structure, and evolutionary aspects. The analysis includes the identification of population structures, allele frequency estimation, and the investigation of hybrids. The expected outcomes are detailed PCA plots, population structure inferences, and allele frequency distributions across different populations.

## Package Installation

Install specific versions of the packages used in this analysis:

**Install the following R packages:**
- `vcfR=1.15.0`
- `ggplot2=3.4.4`
- `ggrepel=0.9.5`
- `adegenet=2.1.10`
- `pegas=1.3`
- `StAMPP=1.6.3`
- `ade4=1.7.22`
- `MASS=7.3.60`
- `adegraphics=1.0.21`
- `geosphere=1.5.18`
- `dplyr=1.1.4`
- `tidyverse=2.0.0`
- `ape=5.7.1`

**Other Tools:**
- `gatk4= 4.5.0.0`
- `gcc 14.0.0` (install using Homebrew)

## Script Files

- `est_cov_pca.r`: An R script file for estimating the covariance matrix and performing PCA.
- `Easy_adegenet_script_and_modified_functions.R`: An R script file for advanced PCA plotting and generating `.dst` files for further analysis in SplitsTree.
- `poly_freq.c`: C source code for calculating allele frequencies from a VCF file.

## Data

### GATK:
**Input File 1** (language: UNIX)
- VCF File: `my_filtered_output.vcf` - The VCF file after initial filtering to include specific populations.

**Output Data:**
- `my_filtered_output.vcf`: The VCF file after initial filtering to include specific populations.
- **Script used:** 

### PCA:
**Input files 2** (Tomas script for PCA) (language: R)
- `my_filtered_output.vcf`: Same output VCF file for GATK processing (reused for outlier removal).

**Output file 2:**
- PCA plot saved as an object in the R environment (not explicitly saved to a file within the script).
- The plot is displayed within the R session when the script runs.
- To save the plot, you would need to add a `ggsave()` function or similar at the end of the script.
- **Script used:** [est_cov_pca.r](https://github.com/thamala/polySV/blob/main/est_cov_pca.r)

### Remove the outliers (Repeat previous steps again):

**GATK** (to create a newer VCF file that only includes variants from the populations you are interested in (without the outliers this time)):
(language: UNIX)
**Input files 5:**
- `Chrom_1_noSnakemake.lyrata.bipassed.dp.m.bt.1pct.ld_pruned.vcf`: This file contains variant data that will be filtered by the command.

**Output Files 5:**
- `my_filtered_output_no_outliers.vcf`: This new VCF file will exclude the specified samples and will contain only the variants from the desired populations without the outliers.
- **Script used:**

### Allele frequency for with and without outliers (language: UNIX):
**Input files 9:**
- With Outliers: 
  - Input VCF File: `my_filtered_output.vcf`: the VCF file containing variant calls
  - Input Populations File: `with_individuals_population_ids.txt` (a text file mapping individuals to their populations).
- Without Outliers:
  - Input VCF File: `my_filtered_output_no_outliers.vcf`: the VCF file after outliers have been removed).
  - Input Populations File: `without_individuals_population_ids_updated.txt`: updated population file reflecting the removal of outliers

**Output files 9:**
- Allele Frequency Output (With Outliers): `freq_with`
- Allele Frequency Output (Without Outliers): `freq_without`
- **Script used:**
  - `poly_freq.c`
  - other script as well (gcc)
  - the script for pops files: to make tab delimited txt file (with and without)individuals_population_ids.txt

### Allele frequency histogram (language: R)

**Input files 10:**
- `freq_with.txt`: This should be a text file containing allele frequency data for the population including outliers. It must include columns for CHROM (chromosome), POS (position), and AF (allele frequency).
- `freq_without.txt`: Similar to freq_with.txt, this file contains allele frequency data for the population excluding outliers, with the same columns for chromosome, position, and allele frequency.

**Output files 10:**
- `Histogram_of_Hybrid_Simulation.pdf`: This is the output file generated by the script. It is a PDF document containing the histogram of mean allele frequencies across the combined datasets. This file is created and saved in the current working directory, unless specified otherwise. You can adjust the file name and path as needed in the pdf() function call.
- **Script used:**



